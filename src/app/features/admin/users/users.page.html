<div class="max-w-7xl mx-auto px-4 py-10 space-y-10">

  <!-- Kopf & Filter ---------------------------------------------------- -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div>
      <h1 class="text-2xl md:text-3xl font-bold text-white">Benutzerverwaltung</h1>
      <p class="text-sm text-gray-400">Konten, Rollen &amp; Freigaben verwalten</p>
    </div>
    <zso-button variant="ghost" size="sm" (click)="refresh()"
                class="text-gray-300 hover:text-white hover:bg-white/5">
      Aktualisieren
    </zso-button>
  </div>

  <div class="glass-card p-6">
    <zso-checkbox [(ngModel)]="showPending"
                  (ngModelChange)="onTogglePending($event)"
                  label="Nur **nicht** genehmigte Benutzer anzeigen"
                  class="text-gray-200">
    </zso-checkbox>
  </div>

  <!-- Liste ------------------------------------------------------------ -->
  <div *ngIf="users$ | async as users" class="space-y-4">

    <p *ngIf="!users.length" class="text-center text-sm text-gray-400">
      Keine Benutzer gefunden.
    </p>

    <div *ngFor="let user of users"
         class="glass-card shimmer-once p-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"
         zsoCardShimmer>

      <!-- Person -->
      <div class="flex-1">
        <h2 class="text-lg font-semibold text-white">
          {{ user.firstName }} {{ user.lastName }}
          <span *ngIf="!user.approved" class="badge bg-amber-500/20 text-amber-300">Pending</span>
          <span *ngIf="user.blocked"  class="badge bg-rose-500/20  text-rose-300">Gesperrt</span>
        </h2>
        <p class="text-sm text-gray-300">{{ user.email }}</p>
        <p class="text-xs text-gray-400">Rolle: {{ user.roles?.[0] || 'user' }}</p>
      </div>

      <!-- Actions -->
      <div class="flex flex-wrap gap-2">
        <zso-button size="sm" variant="primary" *ngIf="!user.approved"
                    (click)="approve(user)">Approve</zso-button>

        <zso-button size="sm" variant="warn" *ngIf="user.blocked"
                    (click)="suspend(user)">Entsperren</zso-button>
        <zso-button size="sm" variant="warn" *ngIf="!user.blocked"
                    (click)="suspend(user)">Sperren</zso-button>

        <zso-button size="sm" variant="ghost"
                    (click)="toggleRole(user)">
          Rolle wechseln
        </zso-button>

        <zso-button size="sm" variant="ghost"
                    (click)="editUser(user)">
          Details
        </zso-button>
      </div>
    </div>
  </div>
</div>
